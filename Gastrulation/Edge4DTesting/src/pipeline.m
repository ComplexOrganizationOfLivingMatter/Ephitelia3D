%%pipeline

GastPath='D:\Pedro\Epithelia3D\Gastrulation\Image_Sequence.mat';

hTranGast={};

%% Gastrulation

% Transition
[hTranGast{end+1,1},hTranGast{end+1,2},hTranGast{end+1,3},hTranGast{end+1,4},hTranGast{end+1,5},hTranGast{end+1,6},hTranGast{end+1,7},hTranGast{end+1,8},hTranGast{end+1,9},hTranGast{end+1,10},hTranGast{end+1,11},hTranGast{end+1,12},hTranGast{end+1,13},hTranGast{end+1,14},hTranGast{end+1,15},hTranGast{end+1,16},hTranGast{end+1,17}]=recalculateCentroidsGastrulationHeightTranPrediction(GastPath,1,9.06,0.76,deg2rad(2.81),10.83,3);
[hTranGast{end+1,1},hTranGast{end+1,2},hTranGast{end+1,3},hTranGast{end+1,4},hTranGast{end+1,5},hTranGast{end+1,6},hTranGast{end+1,7},hTranGast{end+1,8},hTranGast{end+1,9},hTranGast{end+1,10},hTranGast{end+1,11},hTranGast{end+1,12},hTranGast{end+1,13},hTranGast{end+1,14},hTranGast{end+1,15},hTranGast{end+1,16},hTranGast{end+1,17}]=recalculateCentroidsGastrulationHeightTranPrediction(GastPath,5,8.31,0.59,deg2rad(15.96),30.47,3);
[hTranGast{end+1,1},hTranGast{end+1,2},hTranGast{end+1,3},hTranGast{end+1,4},hTranGast{end+1,5},hTranGast{end+1,6},hTranGast{end+1,7},hTranGast{end+1,8},hTranGast{end+1,9},hTranGast{end+1,10},hTranGast{end+1,11},hTranGast{end+1,12},hTranGast{end+1,13},hTranGast{end+1,14},hTranGast{end+1,15},hTranGast{end+1,16},hTranGast{end+1,17}]=recalculateCentroidsGastrulationHeightTranPrediction(GastPath,16,29.21,0.53,deg2rad(5.20),31.22,3);
[hTranGast{end+1,1},hTranGast{end+1,2},hTranGast{end+1,3},hTranGast{end+1,4},hTranGast{end+1,5},hTranGast{end+1,6},hTranGast{end+1,7},hTranGast{end+1,8},hTranGast{end+1,9},hTranGast{end+1,10},hTranGast{end+1,11},hTranGast{end+1,12},hTranGast{end+1,13},hTranGast{end+1,14},hTranGast{end+1,15},hTranGast{end+1,16},hTranGast{end+1,17}]=recalculateCentroidsGastrulationHeightTranPrediction(GastPath,17,11.33,0.61,deg2rad(14.95),29.71,3);
[hTranGast{end+1,1},hTranGast{end+1,2},hTranGast{end+1,3},hTranGast{end+1,4},hTranGast{end+1,5},hTranGast{end+1,6},hTranGast{end+1,7},hTranGast{end+1,8},hTranGast{end+1,9},hTranGast{end+1,10},hTranGast{end+1,11},hTranGast{end+1,12},hTranGast{end+1,13},hTranGast{end+1,14},hTranGast{end+1,15},hTranGast{end+1,16},hTranGast{end+1,17}]=recalculateCentroidsGastrulationHeightTranPrediction(GastPath,18,17.88,0.58,deg2rad(14.36),28.45,3);
[hTranGast{end+1,1},hTranGast{end+1,2},hTranGast{end+1,3},hTranGast{end+1,4},hTranGast{end+1,5},hTranGast{end+1,6},hTranGast{end+1,7},hTranGast{end+1,8},hTranGast{end+1,9},hTranGast{end+1,10},hTranGast{end+1,11},hTranGast{end+1,12},hTranGast{end+1,13},hTranGast{end+1,14},hTranGast{end+1,15},hTranGast{end+1,16},hTranGast{end+1,17}]=recalculateCentroidsGastrulationHeightTranPrediction(GastPath,19,1.76,0.49,deg2rad(5.20),27.70,3);
[hTranGast{end+1,1},hTranGast{end+1,2},hTranGast{end+1,3},hTranGast{end+1,4},hTranGast{end+1,5},hTranGast{end+1,6},hTranGast{end+1,7},hTranGast{end+1,8},hTranGast{end+1,9},hTranGast{end+1,10},hTranGast{end+1,11},hTranGast{end+1,12},hTranGast{end+1,13},hTranGast{end+1,14},hTranGast{end+1,15},hTranGast{end+1,16},hTranGast{end+1,17}]=recalculateCentroidsGastrulationHeightTranPrediction(GastPath,20,13.35,0.62,deg2rad(0.00),30.47,3);
[hTranGast{end+1,1},hTranGast{end+1,2},hTranGast{end+1,3},hTranGast{end+1,4},hTranGast{end+1,5},hTranGast{end+1,6},hTranGast{end+1,7},hTranGast{end+1,8},hTranGast{end+1,9},hTranGast{end+1,10},hTranGast{end+1,11},hTranGast{end+1,12},hTranGast{end+1,13},hTranGast{end+1,14},hTranGast{end+1,15},hTranGast{end+1,16},hTranGast{end+1,17}]=recalculateCentroidsGastrulationHeightTranPrediction(GastPath,21,6.80,0.76,deg2rad(10.31),19.89,3);
[hTranGast{end+1,1},hTranGast{end+1,2},hTranGast{end+1,3},hTranGast{end+1,4},hTranGast{end+1,5},hTranGast{end+1,6},hTranGast{end+1,7},hTranGast{end+1,8},hTranGast{end+1,9},hTranGast{end+1,10},hTranGast{end+1,11},hTranGast{end+1,12},hTranGast{end+1,13},hTranGast{end+1,14},hTranGast{end+1,15},hTranGast{end+1,16},hTranGast{end+1,17}]=recalculateCentroidsGastrulationHeightTranPrediction(GastPath,23,12.59,0.65,deg2rad(13.01),18.13,3);
[hTranGast{end+1,1},hTranGast{end+1,2},hTranGast{end+1,3},hTranGast{end+1,4},hTranGast{end+1,5},hTranGast{end+1,6},hTranGast{end+1,7},hTranGast{end+1,8},hTranGast{end+1,9},hTranGast{end+1,10},hTranGast{end+1,11},hTranGast{end+1,12},hTranGast{end+1,13},hTranGast{end+1,14},hTranGast{end+1,15},hTranGast{end+1,16},hTranGast{end+1,17}]=recalculateCentroidsGastrulationHeightTranPrediction(GastPath,24,6.04,0.64,deg2rad(7.13),30.22,3);



% No transition


[hTranGast{end+1,1},hTranGast{end+1,2},hTranGast{end+1,3},hTranGast{end+1,4},hTranGast{end+1,5},hTranGast{end+1,6},hTranGast{end+1,7},hTranGast{end+1,8},hTranGast{end+1,9},hTranGast{end+1,10},hTranGast{end+1,11},hTranGast{end+1,12},hTranGast{end+1,13},hTranGast{end+1,14},hTranGast{end+1,15},hTranGast{end+1,16},hTranGast{end+1,17}]=recalculateCentroidsGastrulationHeightTranPrediction(GastPath,7,NaN,0.67,deg2rad(72.09),26.19,2);
[hTranGast{end+1,1},hTranGast{end+1,2},hTranGast{end+1,3},hTranGast{end+1,4},hTranGast{end+1,5},hTranGast{end+1,6},hTranGast{end+1,7},hTranGast{end+1,8},hTranGast{end+1,9},hTranGast{end+1,10},hTranGast{end+1,11},hTranGast{end+1,12},hTranGast{end+1,13},hTranGast{end+1,14},hTranGast{end+1,15},hTranGast{end+1,16},hTranGast{end+1,17}]=recalculateCentroidsGastrulationHeightTranPrediction(GastPath,8,NaN,0.56,deg2rad(90.00),32.23,2);
[hTranGast{end+1,1},hTranGast{end+1,2},hTranGast{end+1,3},hTranGast{end+1,4},hTranGast{end+1,5},hTranGast{end+1,6},hTranGast{end+1,7},hTranGast{end+1,8},hTranGast{end+1,9},hTranGast{end+1,10},hTranGast{end+1,11},hTranGast{end+1,12},hTranGast{end+1,13},hTranGast{end+1,14},hTranGast{end+1,15},hTranGast{end+1,16},hTranGast{end+1,17}]=recalculateCentroidsGastrulationHeightTranPrediction(GastPath,9,NaN,0.63,deg2rad(71.58),32.48,2);
[hTranGast{end+1,1},hTranGast{end+1,2},hTranGast{end+1,3},hTranGast{end+1,4},hTranGast{end+1,5},hTranGast{end+1,6},hTranGast{end+1,7},hTranGast{end+1,8},hTranGast{end+1,9},hTranGast{end+1,10},hTranGast{end+1,11},hTranGast{end+1,12},hTranGast{end+1,13},hTranGast{end+1,14},hTranGast{end+1,15},hTranGast{end+1,16},hTranGast{end+1,17}]=recalculateCentroidsGastrulationHeightTranPrediction(GastPath,10,NaN,0.61,deg2rad(77.95),29.71,2);
[hTranGast{end+1,1},hTranGast{end+1,2},hTranGast{end+1,3},hTranGast{end+1,4},hTranGast{end+1,5},hTranGast{end+1,6},hTranGast{end+1,7},hTranGast{end+1,8},hTranGast{end+1,9},hTranGast{end+1,10},hTranGast{end+1,11},hTranGast{end+1,12},hTranGast{end+1,13},hTranGast{end+1,14},hTranGast{end+1,15},hTranGast{end+1,16},hTranGast{end+1,17}]=recalculateCentroidsGastrulationHeightTranPrediction(GastPath,11,NaN,0.53,deg2rad(59.37),30.72,2);
[hTranGast{end+1,1},hTranGast{end+1,2},hTranGast{end+1,3},hTranGast{end+1,4},hTranGast{end+1,5},hTranGast{end+1,6},hTranGast{end+1,7},hTranGast{end+1,8},hTranGast{end+1,9},hTranGast{end+1,10},hTranGast{end+1,11},hTranGast{end+1,12},hTranGast{end+1,13},hTranGast{end+1,14},hTranGast{end+1,15},hTranGast{end+1,16},hTranGast{end+1,17}]=recalculateCentroidsGastrulationHeightTranPrediction(GastPath,12,NaN,0.55,deg2rad(62.95),29.21,2);
[hTranGast{end+1,1},hTranGast{end+1,2},hTranGast{end+1,3},hTranGast{end+1,4},hTranGast{end+1,5},hTranGast{end+1,6},hTranGast{end+1,7},hTranGast{end+1,8},hTranGast{end+1,9},hTranGast{end+1,10},hTranGast{end+1,11},hTranGast{end+1,12},hTranGast{end+1,13},hTranGast{end+1,14},hTranGast{end+1,15},hTranGast{end+1,16},hTranGast{end+1,17}]=recalculateCentroidsGastrulationHeightTranPrediction(GastPath,13,NaN,0.53,deg2rad(8.75),30.47,3);
[hTranGast{end+1,1},hTranGast{end+1,2},hTranGast{end+1,3},hTranGast{end+1,4},hTranGast{end+1,5},hTranGast{end+1,6},hTranGast{end+1,7},hTranGast{end+1,8},hTranGast{end+1,9},hTranGast{end+1,10},hTranGast{end+1,11},hTranGast{end+1,12},hTranGast{end+1,13},hTranGast{end+1,14},hTranGast{end+1,15},hTranGast{end+1,16},hTranGast{end+1,17}]=recalculateCentroidsGastrulationHeightTranPrediction(GastPath,14,NaN,0.63,deg2rad(60.65),32.99,2);
[hTranGast{end+1,1},hTranGast{end+1,2},hTranGast{end+1,3},hTranGast{end+1,4},hTranGast{end+1,5},hTranGast{end+1,6},hTranGast{end+1,7},hTranGast{end+1,8},hTranGast{end+1,9},hTranGast{end+1,10},hTranGast{end+1,11},hTranGast{end+1,12},hTranGast{end+1,13},hTranGast{end+1,14},hTranGast{end+1,15},hTranGast{end+1,16},hTranGast{end+1,17}]=recalculateCentroidsGastrulationHeightTranPrediction(GastPath,15,NaN,0.57,deg2rad(17.12),33.24,3);
[hTranGast{end+1,1},hTranGast{end+1,2},hTranGast{end+1,3},hTranGast{end+1,4},hTranGast{end+1,5},hTranGast{end+1,6},hTranGast{end+1,7},hTranGast{end+1,8},hTranGast{end+1,9},hTranGast{end+1,10},hTranGast{end+1,11},hTranGast{end+1,12},hTranGast{end+1,13},hTranGast{end+1,14},hTranGast{end+1,15},hTranGast{end+1,16},hTranGast{end+1,17}]=recalculateCentroidsGastrulationHeightTranPrediction(GastPath,25,NaN,0.58,deg2rad(81.88),33,2);




clearvars -except hTranGast

hTranGast=cell2table(hTranGast);
hTranGast.Properties.VariableNames{1} = 'motif';
hTranGast.Properties.VariableNames{2} = 'hMeasurements';
hTranGast.Properties.VariableNames{3} = 'hPredict';
hTranGast.Properties.VariableNames{4} = 'hCell';
hTranGast.Properties.VariableNames{5} = 'Degrees';
hTranGast.Properties.VariableNames{6} = 'Curvature';
hTranGast.Properties.VariableNames{7} = 'L12';
hTranGast.Properties.VariableNames{8} = 'L34';
hTranGast.Properties.VariableNames{9} = 'L12PostCurvature';
hTranGast.Properties.VariableNames{10} = 'L34PostCurvature';
hTranGast.Properties.VariableNames{11} = 'CoordA';
hTranGast.Properties.VariableNames{12} = 'CoordB';
hTranGast.Properties.VariableNames{13} = 'LEdgeTransition';
hTranGast.Properties.VariableNames{14} = 'Coord1';
hTranGast.Properties.VariableNames{15} = 'Coord2';
hTranGast.Properties.VariableNames{16} = 'Coord3';
hTranGast.Properties.VariableNames{17} = 'Coord4';

